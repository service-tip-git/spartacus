<form *ngIf="form$ | async as form" [formGroup]="form" (submit)="save(form)">
  <p *cxFeature="'a11yRequiredAsterisks'" class="form-legend">
    {{ 'formLegend.required' | cxTranslate }}
  </p>
  <cx-org-card
    [previous]="false"
    i18nRoot="orgUser.password"
    [cxFocus]="{ autofocus: 'input', refreshFocus: form }"
  >
    <button actions class="button btn btn-sm primary btn-primary">
      {{ 'organization.save' | cxTranslate }}
    </button>
    <button
      actions
      class="link btn btn-link btn-sm"
      routerLink="../"
      type="button"
    >
      {{ 'organization.cancel' | cxTranslate }}
    </button>

    <section main class="details">
      <label class="full-width">
        <span class="label-content"
          >{{ 'orgUser.password.newPassword' | cxTranslate
          }}<ng-template [ngTemplateOutlet]="requiredAsterisk"></ng-template
        ></span>
        <input
          required="true"
          class="form-control"
          type="password"
          name="password"
          placeholder="{{ 'orgUser.password.newPassword' | cxTranslate }}"
          formControlName="password"
          [attr.aria-label]="'orgUser.password.newPassword' | cxTranslate"
          cxPasswordVisibilitySwitch
          [attr.aria-describedby]="'passwordError'"
        />

        <!-- TODO: (CXSPA-7315) Remove feature toggle in the next major -->
        <cx-form-errors
          *cxFeature="'formErrorsDescriptiveMessages'"
          id="passwordError"
          aria-live="off"
          [translationParams]="{
            label: 'orgUser.password.newPassword' | cxTranslate,
          }"
          [control]="form.get('password')"
        ></cx-form-errors>
        <cx-form-errors
          *cxFeature="'!formErrorsDescriptiveMessages'"
          [control]="form.get('password')"
        ></cx-form-errors>
      </label>
      <label>
        <span class="label-content"
          >{{ 'orgUser.password.confirmPassword' | cxTranslate
          }}<ng-template [ngTemplateOutlet]="requiredAsterisk"></ng-template
        ></span>
        <input
          required="true"
          class="form-control"
          type="password"
          name="confirmPassword"
          placeholder="{{ 'orgUser.password.confirmPassword' | cxTranslate }}"
          formControlName="confirmPassword"
          [attr.aria-label]="'orgUser.password.confirmPassword' | cxTranslate"
          [attr.aria-describedby]="'confirmPasswordError'"
          cxPasswordVisibilitySwitch
        />

        <!-- TODO: (CXSPA-7315) Remove feature toggle in the next major -->
        <cx-form-errors
          *cxFeature="'formErrorsDescriptiveMessages'"
          id="confirmPasswordError"
          aria-live="off"
          [translationParams]="{
            label: 'orgUser.password.confirmPassword' | cxTranslate,
          }"
          [control]="form.get('confirmPassword')"
        ></cx-form-errors>
        <cx-form-errors
          *cxFeature="'!formErrorsDescriptiveMessages'"
          [control]="form.get('confirmPassword')"
        ></cx-form-errors>
      </label>
    </section>
  </cx-org-card>
</form>

<ng-template #requiredAsterisk>
  <abbr
    *cxFeature="'a11yRequiredAsterisks'"
    class="text-decoration-none required-asterisk"
    aria-hidden="true"
    title="{{ 'common.required' | cxTranslate }}"
    >*</abbr
  >
</ng-template>
